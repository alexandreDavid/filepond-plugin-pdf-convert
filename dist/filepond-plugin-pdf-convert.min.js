/*!
 * FilePondPluginPdfConvert 1.0.0
 * Licensed under ISC, https://opensource.org/licenses/ISC/
 * Please visit undefined for details.
 */
/* eslint-disable */

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).FilePondPluginPdfConvert=t()}(this,(function(){"use strict";const e=(e,t)=>{const n=[],o=[];let i=0,a=0,d=1;return new Promise(((s,r)=>{try{const r=new FileReader;r.onload=async function(){const r=new Uint8Array(this.result),c=await pdfjsLib.getDocument(r).promise;!async function r(){const u=await c.getPage(d),h=u.getViewport({scale:1.5}),l=document.createElement("canvas"),f=l.getContext("2d"),p={canvasContext:f,viewport:h};l.height=h.height,l.width=h.width,await u.render(p).promise,n.push(f.getImageData(0,0,l.width,l.height)),o.push(a),a+=l.height,i<l.width&&(i=l.width);if(d<c.numPages)d++,r();else{const d=function(){const e=document.createElement("canvas"),t=e.getContext("2d");e.width=i,e.height=a;for(let e=0;e<n.length;e++)t.putImageData(n[e],0,o[e]);return e}(),r=atob(d.toDataURL(t).split(",")[1]),c=[];for(let e=0;e<r.length;e++)c.push(r.charCodeAt(e));const u=new Blob([new Uint8Array(c)],{type:t});s(new File([u],e.name,{type:t}))}}()},r.readAsArrayBuffer(e)}catch(e){r(e)}}))},t=({addFilter:t,utils:n})=>{const{Type:o}=n;return t("LOAD_FILE",((t,{query:n})=>new Promise(((o,i)=>{(e=>/pdf$/.test(e.type))(t)?e(t,n("GET_PDF_CONVERT_TYPE")).then((function(e){o(e)})).catch((()=>o(t))):o(t)})))),{options:{pdfConvertType:["image/png",o.STRING]}}};return"undefined"!=typeof window&&void 0!==window.document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:t})),t}));
