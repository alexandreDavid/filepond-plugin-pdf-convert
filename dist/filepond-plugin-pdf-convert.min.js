/*!
 * FilePondPluginPdfConvert 1.0.0
 * Licensed under ISC, https://opensource.org/licenses/ISC/
 * Please visit undefined for details.
 */
/* eslint-disable */

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).FilePondPluginPdfConvert=t()}(this,(function(){"use strict";const e=(e,t)=>{const n=[],o=[];let i=0,a=0,d=1;return new Promise(((r,s)=>{if("undefined"==typeof pdfjsLib){const e="The library PDF.js is required to convert PDF in image";return console.warn(e),void s(e)}try{const s=new FileReader;s.onload=async function(){const s=new Uint8Array(this.result),c=await pdfjsLib.getDocument(s).promise;!async function s(){const u=await c.getPage(d),f=u.getViewport({scale:1.5}),l=document.createElement("canvas"),h=l.getContext("2d"),p={canvasContext:h,viewport:f};l.height=f.height,l.width=f.width,await u.render(p).promise,n.push(h.getImageData(0,0,l.width,l.height)),o.push(a),a+=l.height,i<l.width&&(i=l.width);if(d<c.numPages)d++,s();else{const d=function(){const e=document.createElement("canvas"),t=e.getContext("2d");e.width=i,e.height=a;for(let e=0;e<n.length;e++)t.putImageData(n[e],0,o[e]);return e}(),s=atob(d.toDataURL(t).split(",")[1]),c=[];for(let e=0;e<s.length;e++)c.push(s.charCodeAt(e));const u=new Blob([new Uint8Array(c)],{type:t});r(new File([u],e.name,{type:t}))}}()},s.readAsArrayBuffer(e)}catch(e){s(e)}}))},t=({addFilter:t,utils:n})=>{const{Type:o}=n;return t("LOAD_FILE",((t,{query:n})=>new Promise(((o,i)=>{(e=>/pdf$/.test(e.type))(t)?e(t,n("GET_PDF_CONVERT_TYPE")).then((function(e){o(e)})).catch((()=>o(t))):o(t)})))),{options:{pdfConvertType:["image/png",o.STRING]}}};return"undefined"!=typeof window&&void 0!==window.document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:t})),t}));
