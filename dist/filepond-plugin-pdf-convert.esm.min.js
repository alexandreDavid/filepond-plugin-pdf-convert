/*!
 * FilePondPluginPdfConvert 1.0.0
 * Licensed under ISC, https://opensource.org/licenses/ISC/
 * Please visit undefined for details.
 */
/* eslint-disable */

const e=(e,t)=>{const n=[],i=[];let o=0,a=0,r=1;return new Promise(((s,d)=>{if("undefined"==typeof pdfjsLib){const e="The library PDF.js is required to convert PDF in image";return console.warn(e),void d(e)}try{const d=new FileReader;d.onload=async function(){const d=new Uint8Array(this.result),c=await pdfjsLib.getDocument(d).promise;!async function d(){const h=await c.getPage(r),u=h.getViewport({scale:1.5}),p=document.createElement("canvas"),l=p.getContext("2d"),w={canvasContext:l,viewport:u};p.height=u.height,p.width=u.width,await h.render(w).promise,n.push(l.getImageData(0,0,p.width,p.height)),i.push(a),a+=p.height,o<p.width&&(o=p.width);if(r<c.numPages)r++,a+=30,d();else{const r=function(){const e=document.createElement("canvas"),t=e.getContext("2d");e.width=o,e.height=a;for(let e=0;e<n.length;e++)t.putImageData(n[e],0,i[e]);return e}(),d=atob(r.toDataURL(t).split(",")[1]),c=[];for(let e=0;e<d.length;e++)c.push(d.charCodeAt(e));const h=new Blob([new Uint8Array(c)],{type:t});s(new File([h],e.name,{type:t}))}}()},d.readAsArrayBuffer(e)}catch(e){d(e)}}))},t=({addFilter:t,utils:n})=>{const{Type:i}=n;return t("LOAD_FILE",((t,{query:n})=>new Promise(((i,o)=>{(e=>/pdf$/.test(e.type))(t)?e(t,n("GET_PDF_CONVERT_TYPE")).then((function(e){i(e)})).catch((()=>i(t))):i(t)})))),{options:{pdfConvertType:["image/png",i.STRING]}}};"undefined"!=typeof window&&void 0!==window.document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:t}));export default t;
